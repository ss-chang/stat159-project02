K <- 40
r <- 0.08
t <- 0.5
S <- 34
sigma <- 0.24
d1 <- (ln(S/K) + (r+0.5(sigma^2))t)/(sigma*t)
d2 <- -sigma*sqrt(t)
Call <- S*rnorm(d1, 0, 1)-Ke^(-r*sigma)*rnorm(d2)
Put <- K*e^(-r*t)*rnorm(-d2, 0, 1)-S*rnorm(-d1, 0, 1)
d1 <- (ln(S/K) + (r+0.5(sigma^2))*t)/(sigma*t)
d1 <- (log(S/K) + (r+0.5(sigma^2))*t)/(sigma*t)
log(S/K)
d1 <- (log(S/K) + (r+ 0.5*(sigma^2))*t)/(sigma*t)
d1
d1 <- (log(S/K) + (r+ (0.5*(sigma^2))*t)/(sigma*sqrt(t))
d1
d1 <- (log(S/K) + (r+ 0.5*(sigma^2)*t)/(sigma*sqrt(t))
d1 <- (log(S/K) + (r+ 0.5*(sigma^2)*t)/(sigma*sqrt(t))
d2 <- -sigma*sqrt(t)
d2
getwd()
library(readr)
credit <- read.csv(file = "../data/Credit.csv", row.names = 1)
credit <- read.csv(file = "../../data/Credit.csv", row.names = 1)
setwd("~/Desktop/RCSDS/project02")
setwd("~/Desktop/RCSDS/project02/code/scripts")
credit <- read.csv(file = "../../data/Credit.csv", row.names = 1)
head(credit)
summary(credit)
IQR(credit)
IQR(credit[1:length(credit)])
credit_summary <- summary(credit)
sd(credit)
sd(credit[c(1:ncol(credit))])
sd(credit[,c(1:ncol(credit))])
head(credit[c(1:ncol(credit)),])
sd(credit[c(1:ncol(credit)),])
sd(credit[c(1, 2, 3, 4, 5, 6, 11),])
sd(credit[c(1, 2, 3, 4, 5, 6, 11)])
sd(credit[,c(1, 2, 3, 4, 5, 6, 11)])
class(credit[,c(1, 2, 3, 4, 5, 6, 11)])
class(credit[1, ])
class(credit[1])
class(credit[,1])
head(credit[,1])
nums <- sapply(credit, is.numeric)
credit[,nums]
nums <- sapply(credit, is.numeric)
nums <- credit[,nums]
sd(nums)
class(nums)
sd(rnorm(20))
sd(matrix(runif(12), 3))
sd(as.data.frame(matrix(runif(20), 4)))
sd(factor(rnorm(5)))
x <- rnorm(10)
sd(x)
x[4:5] <- NA
sd(x)   #   should be NA
sd(x, na.rm = TRUE)
nums <- sapply(credit, is.numeric)
nums <- credit[,nums]
sd(nums)
head(nums)
sd(as.numeric(nums))
sd(as.matrix(nums))
sd(as.matrix(nums[,c(1:length(nums))]))
sd(nums[,c(1:length(nums))])
head(nums)
apply(nums, sd)
apply(nums, 2, sd)
apply(nums, c(nrow(nums),ncol(nums)), sd)
x <- c(nrow(nums),ncol(nums)
x <- c(nrow(nums),ncol(nums))
x
apply(nums, x, sd)
apply(nums, nrow(nums), sd)
nrow(nums)
apply(nums, 400, sd)
apply(nums, 7, sd)
apply(nums, 2, sd)
apply(nums, 1, sd)
apply(nums, 2, IQR)
# sink output
sink(file = "../../data/summary-stats.txt")
# Summary statistics
cat("Summary Statistics for Credit.csv\n")
credit_summary <- summary(credit)
print(credit_summary)
cat("\n\n\n")
# Standard deviations
cat("Standard Deviations:\n")
nums <- sapply(credit, is.numeric)
nums <- credit[,nums]
credit_sds <- apply(nums, 2, sd)
print(credit_sds)
cat("\n\n\n")
# Interquartile ranges
cat("Interquartile Ranges:\n")
credit_iqrs <- apply(nums, 2, IQR)
print(credit_iqrs)
cat("\n\n\n")
# Matrix of correlations
cat("Matrix of Correlations")
credit_cor <- cor(credit, use = "all.obs")
print(credit_cor)
# STOP
sink()
sink(file = "../../data/summary-stats.txt")
# Summary statistics
cat("Summary Statistics for Credit.csv\n")
credit_summary <- summary(credit)
print(credit_summary)
cat("\n\n\n")
# Standard deviations
cat("Standard Deviations:\n")
nums <- sapply(credit, is.numeric)
nums <- credit[,nums]
credit_sds <- apply(nums, 2, sd)
print(credit_sds)
cat("\n\n\n")
# Interquartile ranges
cat("Interquartile Ranges:\n")
credit_iqrs <- apply(nums, 2, IQR)
print(credit_iqrs)
cat("\n\n\n")
# Matrix of correlations
cat("Matrix of Correlations")
credit_cor <- cor(nums, use = "all.obs")
print(credit_cor)
# STOP
sink()
sink(file = "../../data/summary-stats.txt")
# Summary statistics
cat("Summary Statistics for Credit.csv\n")
credit_summary <- summary(credit)
print(credit_summary)
cat("\n\n\n")
# Standard deviations
cat("Standard Deviations:\n")
nums <- sapply(credit, is.numeric)
nums <- credit[,nums]
credit_sds <- apply(nums, 2, sd)
print(credit_sds)
cat("\n\n\n")
# Interquartile ranges
cat("Interquartile Ranges:\n")
credit_iqrs <- apply(nums, 2, IQR)
print(credit_iqrs)
cat("\n\n\n")
# Matrix of correlations
cat("Matrix of Correlations")
credit_cor <- cor(nums, use = "all.obs")
print(credit_cor)
# STOP
sink()
apply(credit, 2, hist)
hist(credit$Gender)
ggplot(credit) +
geom_histogram()
# ==============================================================================
library(ggplot2)
ggplot(credit) +
geom_histogram()
table(credit)
list(credit)
help(list)
frequency(credit)
frequency(credit$Gender)
table(credit$Gender)
hist(table(credit$Gender))
quals <- sapply(credit, is.numeric)
quals <- credit[,quals]
quals_sum<- summary(quals)
print(quals_sum)
quals_sds <- apply(quals, 2, sd)
print(quals_sds)
sink(file = "../../data/summary-stats.txt")
# Summary statistics
cat("Summary Statistics for Quantitative Variables in Credit.csv\n")
quals <- sapply(credit, is.numeric)
quals <- credit[,quals]
quals_sum<- summary(quals)
print(quals_sum)
cat("\n\n\n")
# Standard deviations
cat("Standard Deviations:\n")
quals_sds <- apply(quals, 2, sd)
print(quals_sds)
cat("\n\n\n")
# Interquartile ranges
cat("Interquartile Ranges:\n")
quals_iqrs <- apply(quals, 2, IQR)
print(quals_iqrs)
cat("\n\n\n")
# Matrix of correlations
cat("Matrix of Correlations")
quals_cor <- cor(quals, use = "all.obs")
print(quals_cor)
# STOP
sink()
quals_cor <- cor(quals, use = "all.obs")
print(quals_cor)
apply(quals,2,hist)
head(quals[1, ])
head(quals[,1])
names(quals[,1])
hist(quals[1])
names(quals[1])
names(quals)
x_captions <- c("(in thousands of dollars)",
" (credit limit)",
" (credit rating)",
" (number of credit cards)",
"",
" (years of education)",
" (average credit card debt for a number of individuals)")
hist(quals[,1])
x_captions[1]
paste0(names(quals[1]), x_captions[1]))
paste0(names(quals[1]), x_captions[1])
x_captions <- c(" (in thousands of dollars)",
" (credit limit)",
" (credit rating)",
" (number of credit cards)",
"",
" (years of education)",
" (average credit card debt for a number of individuals)")
for (i in 1:ncol(quals)){
hist(quals[,i],
xlab = paste0(names(quals[i]), x_captions[i]))
}
casefold(names(quals[1]))
paste0("../../images/histogram-",names(quals[1]), ".csv")
paste0("../../images/histogram-",casefold(names(quals[1])), ".csv")
for (i in 1:ncol(quals)){
png(paste0("../../images/histogram-",casefold(names(quals[1])), ".png"))
hist(quals[,i],
xlab = paste0(names(quals[i]), x_captions[i]),
main = paste0(names(quals[i])))
dev.off()
}
for (i in 1:ncol(quals)){
png(paste0("../../images/histogram-",casefold(names(quals[1])), ".png"))
hist(quals[,i],
xlab = paste0(names(quals[i]), x_captions[i]),
main = paste0(names(quals[i])))
dev.off()
}
for (i in 1:ncol(quals)){
print(paste0("../../images/histogram-",casefold(names(quals[1])), ".png"))
}
for (i in 1:ncol(quals)){
png(paste0("../../images/histogram-",casefold(names(quals[i])), ".png"))
hist(quals[,i],
xlab = paste0(names(quals[i]), x_captions[i]),
main = paste0(names(quals[i])))
dev.off()
}
boxplot(credit$Income)
for (i in 1:ncol(quals)){
png(paste0("../../images/boxplot-",casefold(names(quals[i])), ".png"))
boxplot(quals[,i],
xlab = paste0(names(quals[i]), x_captions[i]),
main = paste0(names(quals[i])))
dev.off()
}
for (i in 1:ncol(quals)){
png(paste0("../../images/boxplot-",casefold(names(quals[i])), ".png"))
boxplot(quals[,i],
xlab = paste0(x_captions[i]),
main = paste0(names(quals[i])))
dev.off()
}
for (i in 1:ncol(quals)){
png(paste0("../../images/boxplot-",casefold(names(quals[i])), ".png"))
boxplot(quals[,i],
ylab = paste0(x_captions[i]),
main = paste0(names(quals[i])))
dev.off()
}
png("../../images/scatterplot-matrix.png")
plot(quals)
dev.off()
quans <- sapply(credit, is.character)
quans <- credit[,quans]
head(quans)
head(credit)
class(credit[-1])
class(credit[,-1])
class(credit[-1,])
class(credit$Ethnicity)
quans <- sapply(credit, is.factor)
quans <- credit[,quans]
head(quans)
temp_credit <- model.matrix(Balance ~ ., data = credit)
head(temp_credit)
temp_credit <- model.matrix(Balance ~ ., data = credit)
# Remove first column of 1s and append Balance instead
new_credit <- cbind(temp_credit[ ,-1], Balance = Balance)
help(cbind)
new_credit <- cbind(temp_credit[ ,-1], Balance = credit$Balance)
head(new_credit)
scaled_credit <- scale(new_credit, center = TRUE, scale = TRUE)
scaled_credit <- scale(new_credit, center = TRUE, scale = TRUE)
# Generate output file
write.csv(scaled_credit, file = "../../data/Credit-scaled.csv")
